## Vulnerability Assessments vs Penetration Tests

- **Vulnerability assessments** look for vulnerabilities in networks without simulating cyber attacks.
- A variety of security standards could be used like GDPR compliance or OWASP web security standards.
- During a vulnerability assessment, the assessor will typically run a vulnerabilty scan and then perform validation on critical, high and medium risk vulnerabilities.
	- This means showing evidence that the vuln exists and is not a false positive but not performing privilege escalation, lateral movement, etc.

- **Penetration test** can include manual and automated tactics to assess an org's security posture. 
- A pentest is a simulated cyber attack.

## Vulnerability Assessment Methodology

 ![[VulnerabilityAssessment_Diagram_06a.png|700]]
 ![[2023-03-21 18_19_25-Vulnerability Assessment.png|700]]
## Asset Management
- When planning a cybersecurity strategy an organization should start by creating an inventory of their data assets.
- Once assets are inventoried then asset management can start.

### Asset Inventory
- An org needs to know what it has to know what it needs to defend.
- The inventory should include:
	- Information Technology
	- Operational Technology
	- Physical, software, mobile and developmental assets
- Assests shoud have data classifications to ensure adequate security and access controls.

### Application and System Inventory
- Data assets include:
	- All data stored on-prem:
		- HDDs in endpoints and servers
		- External drives
		- Optical Media
		- Flash media
		- Legacy media (if applicable)
	- All data stored in the cloud:
		- All data stored in all cloud providers
	- All data stored in various SaaS applications.
		- Google Drive
		- Dropbox
		- Microsoft Teams
		- Apple iCloud
		- Adobe Creative Suite
		- Office 365
		- Google Docs
		- etc
	- All of the applications the company needs to conduct normal operations
		- This includes locally deployed apps and cloud deployed/SaaS apps.
	- All of the on-prem networking devices
		- Routers
		- Firewalls
		- Hubs
		- Switches
		- IDS/IPS
		- DLP
		- etc

# Assessment Standards

## Compliance Standards
- The big compliance players in infosec are:
	- PCI
	- HIPPA
	- FISMA
	- ISO 27001
- These accreditations are necessary because it certifies than an org has had a third party vendor evaluate its environment.
- Some companies won't do business with companies without certain accreditations.

### Payment Card Industry Data Security Standard ([PCI DSS](https://www.pcisecuritystandards.org/pci_security/))
- Common standard that implements requirement for orgs that handle credit cards.
- As per governement regulation orgs that store, process or transmit cardholder data must implement PCI DSS guideleines.
- PCI DSS requirements include internal and external scanning of assets.
	- For example, any cardholder data being processed or transmitted must be done in a Cardholder Data Environment (CDE). The CDE must be adequately segmented from normal assets to protect cardholder data from compromise during an attack.

### [HIPAA](https://www.hipaa.com/)
- Used to protect patient health data.
- HIPAA does not necessarily require vulnerability scans or assessments but risk assessment and vulnerability identification are required to maintain accreditation.

### Federal Information Security Management Act [FISMA](https://www.cisa.gov/federal-information-security-modernization-act)
- Standards and guideline used for government operations and information.
- Requires an org to provide documentation and proof of a vulnerability management program to maintain IT CIA.

### [ISO 27001](https://www.iso.org/isoiec-27001-information-security.html)
- Worldwide standard for managing infosec.
- Requires orgs to perform quarterly external and internal scans.

## Penetration Testing Standards

### Penetration Testing Execution Standard ([PTES](http://www.pentest-standard.org/index.php/Main_Page))
- Can be applied to all types on pentests
- Outline phases of a test and how they should be conducted.
- Sections of the PTES:
	- Pre-engagement
	- Intelligence Gathering
	- Threat Modeling
	- Vulnerability Analysis
	- Exploitation
	- Post Exploitation
	- Reporting

### [OSSTMM](https://www.isecom.org/OSSTMM.3.pdf)
- Open Source Security Testing Methodology Manual
- Another set of guidelines for pentests
- Divided to cover different areas of testing:
	- Human Security
	- Physical Security
	- Wireless Communication
	- Telecommunications
	- Data Networks

### [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)
- Has a well known system for designing incident response policies and procedures
- Also has a pentesting framework with the following phases:
	- Planning
	- Discovery
	- Attack
	- Reporting

### OWASP
- Go-to org for defining testing standards and classifying risks to web applications.
- OWASP standards and guides:
	- [Web Security Testing Guide (WSTG)](https://owasp.org/www-project-web-security-testing-guide/)
	- [Mobile Security Testing Guide (MSTG)](https://owasp.org/www-project-mobile-security-testing-guide/)
	- [Firmware Security Testing Methodology](https://github.com/scriptingxss/owasp-fstm)

# Scanning

### [[Nessus]] - local

### [[OpenVAS]] - local

# Reporting
- A strong report has these sections:
	- Executive Summary
	- Overview of Assessment
	- Scope
	- Vulnerabilities and Recommendations

### Executive Summary
- Intended to be readable by an executive who needs a high level overview of details and of what is the most important to fix immediately, depending on the severity.
- Good to include visual aids like below
![[2023-03-22 13_15_50-Vulnerability Assessment.png|500]]

### Overview of Assessment
- Should include any methodology leveraged during the assessment.
	- This should detail the execution of the assment during the testing period and discuss process and tools used (e.g., Nessus)

### Scope and Duration
- This hsould include everything the client authorized for the assessment, including the target scope and testing period.

### Vulnerabilities and Recommendations
- Should detail the findings once all false positives have been manually eliminated.
- Best to group findings that relate to each other based on the issue type or issue severity
- Each issue should have the following elements:
	- Vulnerability Name
	- CVE
	- [CVSS](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)
	- Description of Issue
	- References
	- Remediation Steps
	- Proof of Concept
	- Affected Systems