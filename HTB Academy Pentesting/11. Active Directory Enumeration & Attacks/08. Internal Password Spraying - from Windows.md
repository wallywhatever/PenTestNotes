- From a domain joined Windows host, the [DomainPasswordSpray](https://github.com/dafthack/DomainPasswordSpray) tool is highly effective.
	- If we are authenticated to the domain, the tool will automatically generate a user list from Active Directory, query the domain password policy, and exclude user accounts within one attempt of locking out.

#### Using DomainPasswordSpray.ps1
``` powershell
Import-Module .\DomainPasswordSpray.ps1
Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue
```
![[2023-04-19 12_42_42-Hack The Box - Academy.png|700]]

- We can also use the windows version of kerbrute.

## Password Spraying Mitigations
![[2023-04-19 12_47_17-Hack The Box - Academy.png|700]]