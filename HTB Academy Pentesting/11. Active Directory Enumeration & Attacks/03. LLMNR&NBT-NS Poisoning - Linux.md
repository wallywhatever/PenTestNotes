- A common way to gather credenials and gain an initial foothold on an assessment is a MITM attack on LLMNR and NBT-NS broadcasts.
	- This attack may provide password hashes that can be cracked offline or even cleartext credentials.

### LLMNR & NBT-NS Primer
- [Link-Local Multicast Name Resolution](https://datatracker.ietf.org/doc/html/rfc4795) (LLMNR) and [NetBIOS Name Service](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc940063(v=technet.10)?redirectedfrom=MSDN) (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification that can be used when DNS fails.
	- If a machine tries to resolve a host but DNS fails, ususally he machine will try to get the correct host address via LLMNR.
	- LLMNR uses UDP port `5355` natively.
- If LLMNR fails NBT-NS will be used.
	-  UDP port `137`
- Any host on the network can respond to these requests.
- We can use Responder to poison these requests and spoof an authoritative name server.
	- This is done to get the victim to communicate with our system so we can capture the NetNTLM hash.
		- The hash can be cracked offline or relayed to access other hosts or used against different protocols (like LDAP) on the same host.
		- If combined with a loack of SMB signing it can lead to admin access.

#### Example
1.  A host attempts to connect to the print server at` \\print01.inlanefreight.local`, but accidentally types in `\\printer01.inlanefreight.local`.
2.  The DNS server responds, stating that this host is unknown.
3.  The host then broadcasts out to the entire local network asking if anyone knows the location of `\\printer01.inlanefreight.local`.
4.  The attacker (us with `Responder` running) responds to the host stating that it is the `\\printer01.inlanefreight.local` that the host is looking for.
5.  The host believes this reply and sends an authentication request to the attacker with a username and NTLMv2 password hash.
6.  This hash can then be cracked offline or used in an SMB Relay attack if the right conditions exist.

### Responder
- When on an SSH session, this should be run in tmux
``` bash
sudo responder -I <interface> -v -w -f
```
- `-v` verbosity
- `-f` attempts to fingerprint hosts
- `-w` uses the built in WPAD proxy. Effective against large orginaztions.

- `/usr/share/responder/logs` - hash storage