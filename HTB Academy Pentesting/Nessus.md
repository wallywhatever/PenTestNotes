## Overview
- [Nessus Essentials](https://community.tenable.com/s/article/Nessus-Essentials) is the free version of Nessus Vulnerability Scanner.

## Getting Started with Nessus
- [Download](https://www.tenable.com/downloads/nessus?loginAttempted=true) .deb for ubuntu
- Request activation [code](https://www.tenable.com/products/nessus/activation-code)
- `dpkg i- Nessus.deb`
- `sudo systemctl start nessusd.service`

## Accessing Nessus
- Navigate to `https://localhost:8834`

## Nessus Scan
- New Nessus scans can be configured by clicking `New Scan` and selecting a scan type.
- Description of each scan [type](https://docs.tenable.com/nessus/Content/ScanAndPolicyTemplates.htm).

### Discovery
- Under Host Discovery we have the option to scan for fragile devices.
- Under Port Scanning we can choose to scan common ports, all ports, or custom ranges.
- Under Service Discovery `Probe all ports to find services` is selected by default.

### Assessment
- Under the Assessment category, web app scanning can be enabled and options set.
- Nessus can attempt to authenticate with provided credentials or by using brute force with Hyrda.
- User enumeration can be performed using various techniques like RID Brute Forcing

### Advanced
- Safe checks are enabled by default.
- We can also set performance options to prevent network bottlenecks from our scan or set it to scan IPs in the list in a random order.

### Scan Policies
- These are customized scans that allow us to define specific scan options, save and then have them available to use under Scan Templates when creating a new scan.
- Use the New Policy button in the top right to create
- Select the User Defined tab in Scan Templates to use.

### Nessus Plugins
- Plugins are for specific CVEs and vulnerabilities
- [List](https://www.tenable.com/plugins) of plugins
- We can set plugin rules to exclude false positives or negatives found with plugins.

### Scanning with Credentials
- Has flexible options for doing credentialed scans (LM/NTLM, Kerberos, Password...)
- Also supports database authentication
- Also supports plaintext authentication to services like FTP, HTTP, IMAP, Telnet, etc..

### Nessus Reports
- Scan reports available in .pdf, .html, .csv formats.
	- PDF and HTML reports have an Executive Summary option

### Exporting Nessus Scans
- Two export formats: Nessus or Nessus DB.
	- The Nessus file is an xml file and has a copy of the scan settings and plugin outputs
	- The DB file has the nessus file, plugin Audit Trail, scan attachments, etc.
- Scripts like [nessus-report-downloader](https://raw.githubusercontent.com/eelsivart/nessus-report-downloader/master/nessus6-report-downloader.rb) can quickly down scan results from the CLI using the Nessus REST API

### Mitigating Issues
- If a scan is showing all ports open or no ports open:
	- Configure an Advanced Scan and disable `Ping the remote host` option.
- In sensitive networks, we can use rate limiting
	- In Performance Options modify Max Concurrent Checks Per Host to limit the number of plugins used concurrently on a host.
- Unless specifically requested never perform Denial of Service checks.
	- We can ensure these aren't usedf by enabling the `safe checks` option.
- Use [vnstat](https://humdi.net/vnstat/) `sudo apt install vnstat` to monitor how much traffic the scan is generating
	- `sudo vnstat -l -i <interiface>`