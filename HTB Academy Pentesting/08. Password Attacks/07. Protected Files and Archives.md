## Hunting for Encoded Files
- [This](https://fileinfo.com/filetypes/encoded) is a list of common encrypted/encoded file extensions.

#### Hunting for Files
``` bash
for ext in $(echo ".xls .xls* .xltx .csv .od* .doc .doc* .pdf .pot .pot* .pp*");do echo -e "\nFile extension: " $ext; find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done
```

#### Hunting for SSH Keys
``` bash
grep -rnw "PRIVATE KEY" /* 2>/dev/null | grep ":1"
```

- Most SSH keys we find are encrypted. We can recognize this by the header of the key.
- ![[2023-03-29 18_35_28-Hack The Box - Academy.png|500]]
- Encrypted SSH keys are password protected.

### Cracking with John
``` bash
ssh2john.py SSH.private > ssh.hash
john --wordlist=rockyou.txt ssh.hash

john ssh.hash --show
```

___
## Cracking Documents

#### Cracking Microsoft Office Documents
``` bash
office2john.py Protected.docx > protected-docx.hash
john --wordlist=rockyou.txt protected-docx.hash

john protected-docx.hash --show
```

#### Cracking PDFs
``` bash
pdfjohn.py PDF.pdf > pdf.hash
john --wordlist=rockyou.txt pdf.hash

john protected-docx.hash --show
```

___
# Protected Archives
- [List](https://fileinfo.com/filetypes/compressed) of archive types
- Its not always apparent that an archive is password protected, esp if a file extension is used that does not support password protection

### Cracking OpenSSL Encrypted Archives
- Use `file` to check what a filetype is
	- If encrypted it will return something like
		- `GZIP.gzip: openssl enc'd data with salted password`
	- The safest choice for success is to use `opennssl` in a for-loop that tries to extract the files if guessed correctly.
``` bash
for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null| tar xz;done
```
- Once the loop is finished we can check the folder to see if the contents were extracted.

### Cracking BitLocker Encrypted Drives
- `bitlocker2john` extracts [four different hashes](https://openwall.info/wiki/john/OpenCL-BitLocker) which can be used with different hashcat modes.
- This example uses the first one whic refers to the bitlocker password
``` bash
bitlocker2john -i Backup.vhd > backup.hashes
grep "bitlocker\$0" backup.hashes > backup.hash
cat backup.hash
```

- John or hashcat can work but hashcat is probably better for the gpu acceleration
- The hashcat mode is `-m 22100`
- `hashcat -m 22100 backup.hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt -o backup.cracked`
- View cracked hash: `cat backup.cracked `

- Once cracked the easiest way to mount a bitlocker virtual drive is to transfer it to a windows system and mount it.
	- To do this just double-click the virtual drive. Windows will throw an error. After Mounting we can again double click bitlocker to prompt us for the password.