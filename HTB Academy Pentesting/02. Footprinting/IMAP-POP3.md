- POP3 is basic
	- Allows listing, retreiving and deleting emails.
- IMAP is more advanced
	- Allows online management of emails on server and supports folder structures.
	- Allows synchronization of a local email client with the mailbox on the server.

#### Default Configuration
- Many options
	- Dovecot [core settings](https://doc.dovecot.org/settings/core/) and [service configuration](https://doc.dovecot.org/configuration_manual/service_configuration/).

#### IMAP Commands
![[2023-03-20 13_13_48-Hack The Box - Academy.png | 700]]
- `1 FETCH 1 rfc822` - fetch full message
- [More IMAP Commands](https://www.atmail.com/blog/imap-commands/)
- [IMAP CheetSheet](https://donsutherland.org/crib/imap)


#### POP3 Commands
![[2023-03-20 13_15_09-Hack The Box - Academy.png | 700]]

#### Dangerous Settings
- Generally only applies to on-prem email servers.
![[2023-03-20 13_16_20-Hack The Box - Academy.png | 700]]

#### Footprinting POP3/IMAP
- Default ports:
	- 110, 143 - Unencrypted
	- 993, 995 - TLS/SSL

- **Nmap**
	- `sudo nmap <IP> -sV -p110,143,993,995 -sC`

- **cURL - With Credentials**
	- `curl -k 'imaps://<IP>' --user user:p4ssw0rd`
	- Use `-v` to see the TLS version, certificate details and banner.

- **OpenSSL - TLS Encrypted Interaction POP3**
	- `openssl s_client -connect <IP>:pop3s`

- **OpenSSL - TLS Encrypted Interaction IMAP**
	- `openssl s_client -connect <IP>:imaps`