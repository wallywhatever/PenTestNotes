- We can create a secure webserver for file upload operations that is more robust than uploadserver.
- Nginx is a good alternative to Apache because the configuration is less complicated and we can configure Nginx to easily block webshells.

## Nginx - Enabling PUT

- **Create a directory to handle uploaded files and change the owner to www-data**
	- `sudo mkdir -p /var/www/uploads/SecretUploadDirectory`
	- `sudo chown -R www-data:www-data /var/www/uploads/SecretUploadDirectory`
- **Create Nginx Configuration File**
	- Create the file: `/etc/nginx/sites-available/upload.conf` with the contents:
``` config
server {
    listen 9001;
    
    location /SecretUploadDirectory/ {
        root    /var/www/uploads;
        dav_methods PUT;
    }
}
```
- **Symlink the site to the sites-enabled directory and start nginx**
	- `sudo ln -s /etc/nginx/sites-available/upload.conf /etc/nginx/sites-enabled/`
	- `sudo systemctl restart nginx.service`

- If there are errors check `/var/log/nginx/error.log`
	- Check if port 80 is in use with `ss -lnpt | grep '80'` to get the PID thats holding it
	- Then use `ps -ef | grep 'PID'` to see the process
	- The default Nginx site uses port 80 so we should remove that
		- `sudo rm /etc/nginx/sites-enabled/default`

- **Test Upload using cURL and Verify**
	- `curl -T /etc/passwd http://localhost:9001/SecretUploadDirectory/users.txt`

- **Ensure Directory Listing is not Enabled**
	- Navigate to the directory in a browser and make sure that it's not listing all files
	- This should be off by default in Nginx