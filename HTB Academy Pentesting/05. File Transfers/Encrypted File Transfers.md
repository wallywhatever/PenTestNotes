- Encrypting sensitive data before exfiltrating is essential.
	- Note: Unless specifically requested do not exfiltrate data like PII, financial data, trade secrets, etc. If attempting to test DLP controls, create a file with dummy data that mimics the data the client is trying to protect.
- ==Data leakage during a pentest could have severe consequences for the pen tester, their company and the client.==
- Use secure channels (SSH, SFTP, HTTPS) when possible.

### File Encryption on Windows

#### [Invoke-AESEncryption.ps1](https://www.powershellgallery.com/packages/DRTools/4.0.2.3/Content/Functions%5CInvoke-AESEncryption.ps1)

- **Import Module**
	- `Import-Module .\Invoke-AESEncryption.ps1`
- **Encryption Example**
	- The script creates an encrypted file with the same name but with the '`.aes`' extension
	- `Invoke-AESEncryption.ps1 -Mode Encrypt -Key "p4ssw0rd -Path .\scan-results.txt"`
	- Output will be: `scan-results.txt.aes`

### File Encryption on Linux
- We can use [OpenSSL](https://www.openssl.org/docs/man1.1.1/man1/openssl-enc.html) to encrypt

- **Encrypting /etc/passwd with openssl**
	- `openssl enc -aes256 -iter 100000 -pbkdf2 -in /etc/passwd -out passwd.enc`
		- this will ask for a password and password verification before encrypting
	- `-iter 100000` overrides the default iterations count
	- `-pbkdf2` uses the Password-Based Key Derivation Function 2 algorithm

- **Decrypt passwd.enc with openssl**
	- `openssl enc -d -aes256 -iter 100000 -pbkdf2 -in passwd.enc -out passwd`